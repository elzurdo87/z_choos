/* 
 * Z_choos v 0.1
 * minified
 * autor elzurdo87
 * url: http://elzurdo87.github.io/z_choos/
 
 */
(function(t){function n(){this._this=null;this._width=null;this._height_opt="100";this._selector=null;this._class=null;this._classBold="z_c_bold";this.__data_options=null;this.__id_container=null;this.__id_input=null;this.__id_result_selected=null;this.__id_result_container=null;this.__id_result_c_container=null;this._multiple=false;this._onclick=false;this._disp="float";this._maxresult=false;this._placeholder="";this._no_result=false;this._showSelected=false;this._with_check=false;this._striped=false;this._container=false;this._getWidth=function(){style={width:this._width};return style};this._hide=function(){if(this._disp=="float"&&t("#"+this.__id_result_c_container).is(":visible")){t("#"+this.__id_result_c_container).hide()}};this._getMaxHeight=function(e){if(e){hei=this._height_opt-3;style={"max-height":hei+"px"}}else{style={height:this._height_opt+"px"}}return style};this._init=function(e){if(e.hasOwnProperty("selec")){this._selector=e.selec}if(e.hasOwnProperty("wid")){this._width=e.wid}if(e.hasOwnProperty("height_opt")){this._height_opt=e.height_opt.replace("px","");opciones}if(e.hasOwnProperty("oclick")){if(typeof e.oclick!=="undefined"&&t.isFunction(e.oclick)){this._onclick=e.oclick}else{console.info(e.oclick+" not is a function")}}if(e.hasOwnProperty("disp")){this._disp=e.disp}if(e.hasOwnProperty("wcheck")){if(this._disp=="float"){this._with_check=false}else{this._with_check=e.wcheck}}if(e.hasOwnProperty("maxresult")){this._maxresult=parseInt(e.maxresult)}if(e.hasOwnProperty("placeholder")){this._placeholder=e.placeholder}if(e.hasOwnProperty("showSelected")){this._showSelected=e.showSelected}if(e.hasOwnProperty("striped")){this._striped=e.striped}if(e.hasOwnProperty("noresult")){this._no_result=e.noresult}if(e.hasOwnProperty("container")){this._container=e.container}t("#"+this._selector).addClass("z_choos");if(!this._container){this.__data_options=t("#"+this._selector+" option")}this._multiple=t("#"+this._selector).prop("multiple")}}function r(e){if(t("#"+e).length>0){e="z_choos"+i;i+=1;return r(e)}else{return e}}function s(e){p(e)}function o(e,n){if(e._container){t.each(n,function(t,n){if(n.id===undefined&&n.name===undefined){console.info("Elemento no valido")}else{b(e,n)}});if(t("#"+e.__id_result_selected+" li").length>0){t("#"+e.__id_container).show()}}else{console.error("the element not is a container")}}function u(e){t("#"+e.__id_container).remove();t("#"+e._selector+" option:selected").removeAttr("selected");t("#"+e._selector).show()}function a(n){elements=[];i=0;t.each(t("#"+n.__id_result_selected+" li.z_choos_opt"),function(n,r){texto=t(r).text();val=t(r).children("a").attr("data-key");e={id:val,name:texto};elements[n]=e;n=n+1});return elements}function f(e){if(e._with_check){t("#"+e.__id_result_container+" li.z_choos_li_opt input").trigger("click")}else{t("#"+e.__id_result_container+" li.z_choos_li_opt").trigger("click")}g(e,null)}function l(e){t("#"+e.__id_result_selected+" li.z_choos_opt a").trigger("click")}function c(e){e.__id_container="z_d_"+e._selector;e.__id_input="z_i_"+e._selector;e.__id_result_container="z_rc_"+e._selector;e.__id_result_c_container="z_rc_c_"+e._selector;e.__id_result_selected="z_rs_"+e._selector}function h(e){if(t("#"+e.__id_container).length===0){t("#"+e._selector).after("<div id="+e.__id_container+" ></div>");t("#"+e.__id_container).css(e._getWidth()).hide();t("#"+e.__id_container).append("<ul id="+e.__id_result_selected+' class="z_choos_ul"></ul>');if(!e._container){t("#"+e.__id_container).show();t("#"+e.__id_result_selected).append('<li class="z_choos_input"><input id='+e.__id_input+' autocomplete="off" placeholder="'+e._placeholder+'" type="text"/></li>');t("#"+e.__id_container).append("<div id="+e.__id_result_c_container+' class="z_choos_container"><ul id='+e.__id_result_container+' class="z_choos_ul z_choos_scr" ></ul></div>');t("#"+e.__id_result_c_container).css(e._getMaxHeight(false));t("#"+e.__id_result_container).css(e._getMaxHeight(true));if(e._disp==="float"){t("#"+e.__id_result_c_container).hide();t("#"+e.__id_result_c_container).css(e._getWidth());t("#"+e.__id_result_c_container).css({position:"absolute"})}}}}function p(e){c(e);h(e);if(!e._container){g(e,null);y(e,true)}}function d(e,t){if(e.toLowerCase().indexOf(t.toLowerCase())>=0){return true}else{return false}}function m(e,t,n){texto=t.toLowerCase();id_o=texto.indexOf(n.toLowerCase());needle_len=n.length;needle_texto=t.substr(id_o,needle_len);var r=t.replace(needle_texto,'<span class="'+e._classBold+'">'+needle_texto+"</span>");return r}function g(e,n){t("#"+e.__id_result_container).empty();elem=0;float=false;if(e._disp==="float"){float=true}c_filter=false;for(key in e.__data_options){if(e.__data_options.hasOwnProperty(key)&&/^0$|^[1-9]\d*$/.test(key)){v=e.__data_options[key];add=true;c_filter=false;if(n!==null){c_filter=true;if(d(v.text,n)){add=true}else{add=false}}opt='<li data-id="'+v.value+'" class="z_choos_li_opt';if(float&&elem===0){opt+=" z_d_mark"}selected=false;if(t("#"+e.__id_result_selected+' li.z_choos_opt a[data-key="'+v.value+'"]').length>0){opt+=" z_d_seled";selected=true}if(e._striped&&elem%2===0){opt+=' z_d_back">'}else{opt+='">'}if(e._disp==="inline"){if(e._with_check){opt+='<input type="checkbox" data-id="c'+v.value+'" ';if(selected){opt+=" checked>"}else{opt+=" >"}}}text_show=v.text;if(c_filter){text_show=m(e,text_show,n)}opt+="<span>"+text_show+"</span>";opt+="</li>";if(add){if(!e._showSelected&&selected){}else{t("#"+e.__id_result_container).append(opt);elem+=1}opt=null;add=false}max_cant=false;if(e._maxresult&&elem===e._maxresult){max_cant=true;if(c_filter){y(e,false)}return}}}if(c_filter&&!max_cant){y(e,false)}if(elem==0){if(e._no_result){opt="<li>"+e._no_result+"</li>"}else{opt="<li>No result</li>"}t("#"+e.__id_result_container).append(opt);opt=null}}function y(e,n){if(n){t("#"+e.__id_result_selected).on("click",e,function(e){t("#"+e.data.__id_input).focus();e.stopPropagation()});t("#"+e.__id_input).on("keyup",e,function(e){keyNum=e.keyCode;if(keyNum!=40&&keyNum!=39&&keyNum!=38&&keyNum!=37&&keyNum!=13){t("#"+e.data.__id_result_c_container).show();g(e.data,t(this).val());t("#"+e.data.__id_result_container).scrollTop(0)}});t("#"+e.__id_input).on("focusin",e,function(e){if(e.data._disp=="float"&&t("#"+e.data.__id_result_c_container).is(":hidden")){t("#"+e.data.__id_result_c_container).show()}e.stopPropagation()});t("#"+e.__id_input).on("focusout",e,function(e){if(e.data._disp=="float"&&t("#"+e.data.__id_result_c_container).is(":visible")&&!t("#"+e.data.__id_result_c_container).is(":hover")){t("#"+e.data.__id_result_c_container).hide()}e.stopPropagation()});t("#"+e.__id_input).bind("keydown",e,function(n){var r=n.keyCode;switch(r){case 13:n.preventDefault();if(!e._with_check){if(!t("#"+n.data.__id_result_c_container).is(":hidden")){t("#"+n.data.__id_result_container+" li.z_choos_li_opt.z_d_mark").trigger("click")}}break;case 40:n.preventDefault();if(t("#"+n.data.__id_result_container+" li.z_choos_li_opt.z_d_mark").next().length>0){t("#"+n.data.__id_result_container+" li.z_choos_li_opt.z_d_mark").removeClass("z_d_mark").next().addClass("z_d_mark")}S(n.data,"down");break;case 38:n.preventDefault();if(t("#"+n.data.__id_result_container+" li.z_choos_li_opt.z_d_mark").prev().length>0){t("#"+n.data.__id_result_container+" li.z_choos_li_opt.z_d_mark").removeClass("z_d_mark").prev().addClass("z_d_mark")}S(n.data,"up");break;case 8:if(t("#"+n.data.__id_input).val().length==0){n.preventDefault();t("#"+n.data.__id_result_selected+" .z_choos_opt a").last().trigger("click");g(n.data,t("#"+n.data.__id_input).val())}break;default:}})}if(e._with_check){t("#"+e.__id_result_container+" :checkbox").on("change",e,function(e){e.stopPropagation();if(e.target.checked){w(e.data,this);if(e.data._showSelected){t(this).parent().addClass("z_d_seled")}else{t(this).parent().hide()}}else{E(e.data,t(this).parent().attr("data-id"))}});t("#"+e.__id_result_container+" .z_choos_li_opt").on("click",e,function(e){e.stopPropagation();if(e.target.type!="checkbox"){if(e.data._onclick){t(e.data._onclick(this))}}})}else{t("#"+e.__id_result_container+" .z_choos_li_opt").on("click",e,function(e){e.stopPropagation();if(e.data._multiple){if(!t(this).hasClass("z_d_seled")){w(e.data,this);if(e.data._showSelected){t(this).addClass("z_d_seled")}else{t(this).hide()}if(e.data._onclick){t(e.data._onclick(this))}}}else{if(t("#"+e.data.__id_result_selected+" .z_choos_opt").length>0){}else{w(e.data,this);if(e.data._showSelected){t(this).addClass("z_d_seled")}else{t(this).hide()}g(e.data,t("#"+e.data.__id_input).val());if(e.data._onclick){t(e.data._onclick(this))}}}if(e.data._disp=="float"){t("#"+e.data.__id_result_c_container).hide()}});t("#"+e.__id_result_container+" .z_choos_li_opt").on("mouseover",e,function(e){e.stopPropagation();t("#"+e.data.__id_result_container+" .z_choos_li_opt").removeClass("z_d_mark");t(this).addClass("z_d_mark")})}}function b(e,n){if(t("#"+e._selector+' option[value="'+n.id+'"]').length>0){}else{t("#"+e._selector).append("<option value="+n.id+">"+n.name+"</option>")}t("#"+e._selector+' option[value="'+n.id+'"]').attr("selected",true);if(t("#"+e.__id_result_selected+' .z_choos_opt_rem[data-key="'+n.id+'"]').length>0){}else{var r='<li class="z_choos_opt"><span>'+n.name+'</span><a class="z_choos_opt_rem" data-key="'+n.id+'"><span class="glyphicon glyphicon-remove"></span></a></li>';t("#"+e.__id_result_selected).append(r);t("#"+e.__id_result_selected+' .z_choos_opt_rem[data-key="'+n.id+'"]').on("click",function(n){n.stopPropagation();key=t(this).attr("data-key");E(e,key)})}}function w(e,n){if(e._with_check){text=t(n).parent().text();key=t(n).parent().attr("data-id")}else{key=t(n).attr("data-id");text=t(n).text()}var r='<li class="z_choos_opt"><span>'+text+'</span><a class="z_choos_opt_rem" data-key="'+key+'"><span class="glyphicon glyphicon-remove"></span></a></li>';t(r).insertBefore("#"+e.__id_result_selected+" .z_choos_input");t("#"+e._selector+' option[value="'+key+'"]').attr("selected",true);if(!e._multiple){t("#"+e.__id_result_selected+" li.z_choos_opt").width("95%");t("#"+e.__id_result_selected+" li.z_choos_input").hide();t("#"+e.__id_result_container+" :checkbox").attr("disabled",true)}t("#"+e.__id_result_selected+' .z_choos_opt_rem[data-key="'+key+'"]').on("click",function(n){n.stopPropagation();key=t(this).attr("data-key");E(e,key)});if(!e._with_check&&!e._multiple){g(e,t("#"+e.__id_input).val())}}function E(e,n){t("#"+e.__id_result_selected+' .z_choos_opt_rem[data-key="'+n+'"]').parent().remove();if(e._container){if(t("#"+e.__id_result_selected+" .z_choos_opt_rem").length==0){t("#"+e.__id_container).hide()}}else{t("#"+e.__id_result_container+" :checkbox").attr("disabled",false);t("#"+e.__id_result_selected+" li.z_choos_input").show();t("#"+e.__id_result_container+' li[data-id="'+n+'"]').removeClass("z_d_seled");t("#"+e.__id_result_container+' li[data-id="'+n+'"] :checkbox').removeAttr("checked");g(e,t("#"+e.__id_input).val())}t("#"+e._selector+' option[value="'+n+'"]').removeAttr("selected")}function S(e,n){height_contenedor=t("#"+e.__id_result_container).height();pos_contenedor=t("#"+e.__id_result_container).offset().top;pos_scrol=t("#"+e.__id_result_container).scrollTop();if(t("#"+e.__id_result_container+" li.z_choos_li_opt.z_d_mark").length>0){offtop=t("#"+e.__id_result_container+" li.z_choos_li_opt.z_d_mark").offset().top;postop=t("#"+e.__id_result_container+" li.z_choos_li_opt.z_d_mark").offset().top;if(n=="down"){alt_yo=t("#"+e.__id_result_container+" li.z_choos_li_opt.z_d_mark").height();hei=height_contenedor+pos_contenedor;if(offtop+alt_yo>=hei){t("#"+e.__id_result_container).scrollTop(pos_scrol+alt_yo)}}else if(n=="up"){alt_ant=t("#"+e.__id_result_container+" li.z_choos_li_opt.z_d_mark").prev().height();if(alt_ant==null){alt_ant=0}if(offtop+10<pos_contenedor){if(alt_ant==0){t("#"+e.__id_result_container).scrollTop(0)}else{t("#"+e.__id_result_container).scrollTop(pos_scrol-alt_ant)}}}}else{t("#"+e.__id_result_container+" li.z_choos_li_opt:first-child").addClass("z_d_mark")}}_methods={init:s,get:a,select_all:f,unselect_all:l,add:o,destroy:u};t.fn.z_choos=function(e,i){if(typeof e==="string"){if(_methods[e]){if(t(this).data("z_choos")){ins=t(this).data("z_choos")}else{id=t(this).prop("id");if(id==""){id="z_choos";id=r(id);t(this).attr("id",id)}v_param={selec:id,wid:this.width()};attre=t.extend(v_param,i||{});ins=new n;ins._init(attre);t(this).data("z_choos",ins)}if(e==="add"){return _methods[e](ins,i)}else if(e==="destroy"){if(t(this).data("z_choos")){ins=t(this).data("z_choos");t(this).removeData("z_choos");return _methods[e](ins)}}else{return _methods[e](ins)}}else{console.error("metodo no definido")}}else{console.error("metodo no definido")}}})(jQuery)
